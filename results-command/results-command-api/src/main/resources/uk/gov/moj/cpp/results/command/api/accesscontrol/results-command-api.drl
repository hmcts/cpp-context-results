package uk.gov.moj.cpp.results.command.api.accesscontrol;

import uk.gov.moj.cpp.accesscontrol.drools.Outcome;
import uk.gov.moj.cpp.accesscontrol.drools.Action;
import uk.gov.moj.cpp.results.command.api.accesscontrol.RuleConstants;

global uk.gov.moj.cpp.accesscontrol.common.providers.UserAndGroupProvider userAndGroupProvider;

rule "Command - Rule for add hearing result"
  when
    $outcome: Outcome();
    $action: Action(name == "results.add-hearing-result");
    eval(userAndGroupProvider.isMemberOfAnyOfTheSuppliedGroups($action, RuleConstants.getUpdateNowsStatusActionGroups()));
  then
    $outcome.setSuccess(true);
end

rule "Command - Rule for generate police results for a defendant"
  when
    $outcome: Outcome();
    $action: Action(name == "results.command.generate-police-results-for-a-defendant");
    eval(true);
  then
    $outcome.setSuccess(true);
end

rule "Command - Rule for creating hearing results"
  when
    $outcome: Outcome();
    $action: Action(name == "results.api.create-results");
    eval(userAndGroupProvider.isMemberOfAnyOfTheSuppliedGroups($action, RuleConstants.getCreateResultsActionGroups()));
  then
    $outcome.setSuccess(true);
end

rule "Command - Rule for tracking hearing results"
  when
    $outcome: Outcome();
    $action: Action(name == "results.api.track-results");
    eval(userAndGroupProvider.isMemberOfAnyOfTheSuppliedGroups($action, RuleConstants.getUpdateNowsStatusActionGroups()));
  then
    $outcome.setSuccess(true);
end


